<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <title> bash条件判断 · 言在语中 </title>
    <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="browsermode" content="application">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="言在语中">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="msapplication-navbutton-color" content="#666666">
<meta name= "format-detection" content="telephone=no" />
<meta name="keywords" content="nlvi, Nlvi" />





    <meta name="keywords" content="linux, bash, 脚本, Nlvi" />

<link rel="stylesheet" href="/style/style.css">
<script src="/script/jquery.min.js"></script>
<script>
    var CONFIG = {
        title: "言在语中",
        author: "nigaha",
        lightbox: true,
        animate: true
    }
</script>



    <link rel="stylesheet" href="/lightbox/css/lightbox.min.css">




    <link rel="stylesheet" href="/syuanpi/syuanpi.min.css">










</head>
<body>
    <div class="progress">
    <div class="progress-inner"></div>
</div>
    <div class="body">
    <div class="tagcloud-mask"></div>  
<div class="tagcloud" id="tagcloud">
    <div class="tagcloud-inner">
        <a href="/tags/DHCP/" style="font-size: 14px;">DHCP</a> <a href="/tags/DNS/" style="font-size: 14px;">DNS</a> <a href="/tags/Kickstart应答文件/" style="font-size: 14px;">Kickstart应答文件</a> <a href="/tags/RAID/" style="font-size: 14px;">RAID</a> <a href="/tags/awk/" style="font-size: 14px;">awk</a> <a href="/tags/bash/" style="font-size: 14px;">bash</a> <a href="/tags/cobbler/" style="font-size: 14px;">cobbler</a> <a href="/tags/github/" style="font-size: 14px;">github</a> <a href="/tags/grep/" style="font-size: 14px;">grep</a> <a href="/tags/hexo/" style="font-size: 14px;">hexo</a> <a href="/tags/linux/" style="font-size: 14px;">linux</a> <a href="/tags/sed/" style="font-size: 14px;">sed</a> <a href="/tags/vim/" style="font-size: 14px;">vim</a> <a href="/tags/三剑客/" style="font-size: 14px;">三剑客</a> <a href="/tags/变量/" style="font-size: 14px;">变量</a> <a href="/tags/实验/" style="font-size: 14px;">实验</a> <a href="/tags/文件管理/" style="font-size: 14px;">文件管理</a> <a href="/tags/文本工具/" style="font-size: 14px;">文本工具</a> <a href="/tags/服务servers/" style="font-size: 14px;">服务servers</a> <a href="/tags/正则表达式/" style="font-size: 14px;">正则表达式</a> <a href="/tags/理论/" style="font-size: 14px;">理论</a> <a href="/tags/脚本/" style="font-size: 14px;">脚本</a> <a href="/tags/自动化安装系统/" style="font-size: 14px;">自动化安装系统</a>
    </div>
</div>
    <header class="header" id="header">
    <div class="title syuanpi tvIn">
    <div class="table">
        <div class="connect">
            <div class="connect-inner">
                <span><a href="/">言在语中</a></span>
                
            </div>
        </div>
    </div>
</div>
    <nav class="main-nav syuanpi tvIn">
<div class="table">

    <ul class="menu">
        
        <li class="menu-item">
            <a href="javascript:;" id="search">
                <span>搜索</span>
                
                    <span class="menu-item-label">search</span>
                
            </a>
        </li>
        
        
        
            <li class="menu-item">
                <a href="/">
                    <span>文章</span>
                    
                        <span class="menu-item-label">article</span>
                    
                </a>
            </li>
        
        
        
            <li class="menu-item">
                <a href="/archives">
                    <span>归档</span>
                    
                        <span class="menu-item-label">archives</span>
                    
                </a>
            </li>
        
        
        
            <li class="menu-item">
                <a href="javascript:;" id="tags">
                    <span>标签</span>
                    
                        <span class="menu-item-label">tags</span>
                    
                </a>
            </li>
        
        
        
            <li class="menu-item">
                <a href="/about">
                    <span>关于</span>
                    
                        <span class="menu-item-label">about</span>
                    
                </a>
            </li>
        
        
    </ul>

</div>
</nav>
</header>
<div class="mobile-header">
    <div class="mobile-header-body">
        <div class="mobile-header-list">
            
            
                <div class="mobile-nav-item">
                    <a href="/">
                        <span>文章</span>
                        
                            <span class="menu-item-label">article</span>
                        
                    </a>
                </div>
            
            
            
                <div class="mobile-nav-item">
                    <a href="/archives">
                        <span>归档</span>
                        
                            <span class="menu-item-label">archives</span>
                        
                    </a>
                </div>
            
            
            
                <div class="mobile-nav-item inner-cloud">
                    <div class="mobile-nav-tag">
                        <a href="javascript:;" id="mobile-tags">
                            <span>标签</span>
                            
                                <span class="menu-item-label">tags</span>
                            
                        </a>
                    </div>
                    <div class="mobile-nav-tagcloud">
                        <div class="mobile-tagcloud-inner">
                            <a href="/tags/DHCP/" style="font-size: 14px;">DHCP</a> <a href="/tags/DNS/" style="font-size: 14px;">DNS</a> <a href="/tags/Kickstart应答文件/" style="font-size: 14px;">Kickstart应答文件</a> <a href="/tags/RAID/" style="font-size: 14px;">RAID</a> <a href="/tags/awk/" style="font-size: 14px;">awk</a> <a href="/tags/bash/" style="font-size: 14px;">bash</a> <a href="/tags/cobbler/" style="font-size: 14px;">cobbler</a> <a href="/tags/github/" style="font-size: 14px;">github</a> <a href="/tags/grep/" style="font-size: 14px;">grep</a> <a href="/tags/hexo/" style="font-size: 14px;">hexo</a> <a href="/tags/linux/" style="font-size: 14px;">linux</a> <a href="/tags/sed/" style="font-size: 14px;">sed</a> <a href="/tags/vim/" style="font-size: 14px;">vim</a> <a href="/tags/三剑客/" style="font-size: 14px;">三剑客</a> <a href="/tags/变量/" style="font-size: 14px;">变量</a> <a href="/tags/实验/" style="font-size: 14px;">实验</a> <a href="/tags/文件管理/" style="font-size: 14px;">文件管理</a> <a href="/tags/文本工具/" style="font-size: 14px;">文本工具</a> <a href="/tags/服务servers/" style="font-size: 14px;">服务servers</a> <a href="/tags/正则表达式/" style="font-size: 14px;">正则表达式</a> <a href="/tags/理论/" style="font-size: 14px;">理论</a> <a href="/tags/脚本/" style="font-size: 14px;">脚本</a> <a href="/tags/自动化安装系统/" style="font-size: 14px;">自动化安装系统</a>
                        </div>
                    </div>
                </div>
            
            
            
                <div class="mobile-nav-item">
                    <a href="/about">
                        <span>关于</span>
                        
                            <span class="menu-item-label">about</span>
                        
                    </a>
                </div>
            
            
        </div>
    </div>
    <div class="mobile-header-nav">
        <div class="mobile-header-item" id="mobile-left">
            <div class="header-menu-item">
                <span class="header-menu-line"></span>
            </div>
        </div>
        <h1 class="mobile-header-title">
            <a href="/">言在语中</a>
        </h1>
        <div class="mobile-header-item"></div>
    </div>
</div>

    <div class="container">
        <main class="main" id="main">
            
    
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年5月3日</span>
                
                
                    <span class="post-category"><a href="/categories/linux/">linux</a></span>
                
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                bash条件判断
            
            </h1>
            
                
                    <div class="post-tags syuanpi riseIn-light back-3">
                    
                        <a href="/tags/linux/">linux</a>
                    
                        <a href="/tags/bash/">bash</a>
                    
                        <a href="/tags/脚本/">脚本</a>
                    
                    </div>
                
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                <h3 id="bash条件判断及组合条件判断"><a href="#bash条件判断及组合条件判断" class="headerlink" title="bash条件判断及组合条件判断"></a>bash条件判断及组合条件判断</h3><a id="more"></a>
<p><strong><strong>bash 条件判断</strong></strong></p>
<ul>
<li>如果用户不存在<ul>
<li>添加用户，给密码并显示添加成功</li>
</ul>
</li>
<li>否则(目标存在)<ul>
<li>显示如果已经存在，没有添加</li>
</ul>
</li>
</ul>
<p><strong><strong>bash脚本语法检测：</strong></strong></p>
<ul>
<li>bash -n filetest.sh</li>
</ul>
<p><strong><strong>bash脚本单步执行显示：</strong></strong></p>
<ul>
<li>bash -x filetest.sh</li>
</ul>
<h4 id="bash中实现条件判断"><a href="#bash中实现条件判断" class="headerlink" title="bash中实现条件判断"></a>bash中实现条件判断</h4><p><strong><strong>条件判断测试类型</strong></strong></p>
<ul>
<li>整数测试:<ul>
<li>A是否为6,$A是否为6</li>
</ul>
</li>
<li>字符测试：<ul>
<li>变量保存是否为A、B、C、D</li>
</ul>
</li>
<li>文件测试：<ul>
<li>判断一个文件是否存在</li>
</ul>
</li>
</ul>
<h4 id="条件测试的表达式描述"><a href="#条件测试的表达式描述" class="headerlink" title="条件测试的表达式描述"></a>条件测试的表达式描述</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">	[ expression ]			bash命令</div><div class="line">	[[ expression ]]		bash关键字</div><div class="line">	test expression			text命令</div><div class="line"></div><div class="line">INT1=66</div><div class="line">INT2=99</div><div class="line">[ $INT1 -eq $INT2 ]</div><div class="line">[[ $INT1 -eq $INT2 ]]</div><div class="line">test $INT1 -eq $INT2</div></pre></td></tr></table></figure>
<p><strong><strong>整数比较：</strong></strong></p>
<ul>
<li>-eq    相等</li>
<li>-ne    不等</li>
<li>-gt    大于</li>
<li>-lt    小于</li>
<li>-ge    大于等于</li>
<li>-le    小于等于</li>
</ul>
<p><strong><strong>字符测试：</strong></strong></p>
<p>[ $A = $B ] 等号两边都需要加空格，不然会被认为是附值。</p>
<ul>
<li>== : 测试是否相等，相等为真，不等为假</li>
<li>!= : 测试是否不等，不等为真，相等为假</li>
<li>>  : 大于</li>
<li>&lt;  : 小于</li>
<li>-n string ： 测试指定字符串是否为空，空则真，不空则假</li>
<li>-s string ： 测试指定字符串是否为不空，不空为真，空则为假</li>
</ul>
<p><strong><strong>文件测试：</strong></strong></p>
<ul>
<li>-e FILE: 测试文件是否存在</li>
<li>-f FILE: 测试文件是否为普通文件</li>
<li>-d FILE: 测试指定路径是否为目录</li>
<li>-r FILE: 测试当前用户对指定文件是否有读取权限</li>
<li>-w FILE: 测试当前用户对指定文件是否有写入权限</li>
<li>-x FILE: 测试当前用户对指定文件是否有执行权限</li>
</ul>
<p>[ -e /etc/inittab ]<br>[ -x /etc/rc.d/rc.sysinit ]</p>
<p><strong><strong>组合测试条件：</strong></strong></p>
<ul>
<li>-a：与关系</li>
<li>-o：或关系</li>
<li>!：非关系</li>
</ul>
<h4 id="命令间的逻辑关系："><a href="#命令间的逻辑关系：" class="headerlink" title="命令间的逻辑关系："></a>命令间的逻辑关系：</h4><ul>
<li><p>逻辑或（||）：如果前面真，后面不判断</p>
<ul>
<li>如果前面假，后面必须判断</li>
</ul>
</li>
<li><p>逻辑与（&amp;&amp;）：如果前面假，后面不判断</p>
<ul>
<li>如果前面真，后面必须判断<ul>
<li>例：id user1 &amp;&gt; /dev/null &amp;&amp; echo “Hello,deny”</li>
</ul>
</li>
</ul>
<ul>
<li>扩展：如果用户不存在，就添加用户(user2)<ul>
<li>! id user2 &amp;&gt; /dev/null &amp;&amp; useradd user2</li>
<li>id user2 &amp;&gt; /dev/null || useradd user2</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong><strong>exit可以直接退出当前脚本，并赋予一条执行状态</strong></strong></p>
<ul>
<li>exit number（数值在0~255之间，0为成功，其他为不成功）            </li>
</ul>
<h5 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h5><ul>
<li>脚本结束变量就会撤销（变量的好处就是一次性修改能够应用到整个程序中）；</li>
<li>如果脚本没有明确定义退出状态码，那么，最后执行的命令的退出码即为脚本的退出状态码；</li>
</ul>
<p><strong><strong>bash 变量的类型：</strong></strong></p>
<ul>
<li>本地变量：<ul>
<li>当前shell工作的进程</li>
</ul>
</li>
<li>（局部变量）</li>
<li>环境变量：<ul>
<li>当前shell及其子shell</li>
</ul>
</li>
<li>位置变量：<ul>
<li>$1,$2,…（位置变量$1就是脚本中的第一个参数）</li>
<li>shift（轮换）</li>
</ul>
</li>
<li><p>特殊变量：</p>
<ul>
<li>$*：参数列表</li>
<li>$@：参数列表</li>
<li>$#：参数的个数</li>
<li>$?：上个命令的退出状态，或函数的返回值。</li>
</ul>
</li>
</ul>
<p>命令：<br>    修正文件执行特性<br>参数：<br>    命令的作用对象</p>
<p><strong><strong>变量名称规则：</strong></strong></p>
<ul>
<li>1.只能包含字母、数字和下划线，并且不能数字开头； </li>
<li>2.不应该根系统中已有的环境变量重名；</li>
<li>3.见名知意</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">LINES=`wc -l /etc/inittab`</div><div class="line">echo $LINES</div></pre></td></tr></table></figure>
<p>执行结果为:53 /etc/inittab<br><code>要引用命令的返回结果要使用命令替换，把wc命令的结果保存在LINES变量当中；</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">FINLINES=`echo $LINES | cut -d &apos; &apos; -fi`</div><div class="line">echo $FINLINES</div></pre></td></tr></table></figure>
<p>执行结果为:53</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ $FINLINES -gt 100 ] &amp;&amp; echo &quot;/etc/inittab is a big file&quot; || echo &quot;/etc/inittab is a small file&quot;</div></pre></td></tr></table></figure>
<p>输出结果为：/etc/inittab is a small file</p>
<p><code>[ $FINLINES -gt 100 ] &amp;&amp; echo &quot;/etc/inittab is a big file&quot;的结果为假，执行结果为空；</code></p>
<p>分步骤判断就是：<br><code>假 || echo &quot;/etc/inittab is a small file&quot;</code></p>
<p><strong><strong>总结：</strong></strong></p>
<ul>
<li>当&amp;&amp;判断得出的结果为假时，则执行 || 的判断输出。</li>
<li>当&amp;&amp;判断得出的结果为真时，则不执行 || 判断</li>
</ul>
<p>同理：<br>id user1 &amp;&amp; echo “user1 exists” || useradd user1<br><code>如果用户存在，就显示用户已存在。否则，就添加此用户。</code></p>
<p>! id user1 &amp;&amp; useradd user1 || echo “user1 exists”<br><code>如果用户不存在，就添加此用户。否则，显示其已经存在。</code></p>
<p>! id user1 &amp;&amp; useradd user1 &amp;&amp; echo “user1” | passwd –stdin user1 || echo “user1 exists”<br><code>如果用户不存在，添加用户并给予密码。否则，显示其已经存在。</code></p>
<h4 id="示例1："><a href="#示例1：" class="headerlink" title="示例1："></a>示例1：</h4><p>1、添加3个用户user1、user2、user3，但要求先判断用户是否存在，不存在而后再添加<br>2、显示当前系统上共有多少个用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">! id user1 &amp;&gt; /dev/null &amp;&amp; useradd user1 &amp;&amp; echo &quot;user1&quot; | passwd --stdin user1 &amp;&gt; /dev/null || echo &quot;user1 exists&quot;</div><div class="line">! id user2 &amp;&gt; /dev/null &amp;&amp; useradd user2 &amp;&amp; echo &quot;user2&quot; | passwd --stdin user2 &amp;&gt; /dev/null || echo &quot;user2 exists&quot;</div><div class="line">! id user3 &amp;&gt; /dev/null &amp;&amp; useradd user3 &amp;&amp; echo &quot;user3&quot; | passwd --stdin user3 &amp;&gt; /dev/null || echo &quot;user3 exists&quot;</div><div class="line"></div><div class="line">USERS=`wc -l /etc/passwd | cut -d: -f1`</div><div class="line">echo &quot;$USERS users&quot;</div></pre></td></tr></table></figure></p>
<h4 id="示例2："><a href="#示例2：" class="headerlink" title="示例2："></a>示例2：</h4><p>1、如果用户UID为0，显示其为管理员<br>2、否则，显示其为普通用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">NAME=root</div><div class="line">#NAME=user1</div><div class="line">USERID=`id -u $NAME`</div><div class="line">[ $USERID -eq 0 ] &amp;&amp; echo &quot;Admin&quot; || echo &quot;Common user&quot;</div></pre></td></tr></table></figure></p>
<p><strong><strong>条件判断，控制结构</strong></strong></p>
<h4 id="要求："><a href="#要求：" class="headerlink" title="要求："></a>要求：</h4><p><code>如果if和then在同一行必须写为</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if [[ condition ]]; then</div><div class="line">	#statements</div><div class="line">fi</div></pre></td></tr></table></figure>
<p><code>也可以写为</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">if [[ condition ]]</div><div class="line">	then</div><div class="line">	#statements</div><div class="line">fi</div></pre></td></tr></table></figure>
<p><strong><strong>单分支if语句</strong></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">if 判断条件； then	#如果判断条件为真，则then执行后面语句</div><div class="line">	语句1		#语句statement</div><div class="line">	语句2		#单分支语句如果不满足，就略过不会继续执行</div><div class="line">	。。。</div><div class="line">fi</div></pre></td></tr></table></figure></p>
<p><strong><strong>双分支的if语句</strong></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">if 判断条件； then	#如果判断条件为真，则then执行后面语句</div><div class="line">	语句1</div><div class="line">	语句2</div><div class="line">	。。。</div><div class="line">else			#如果判断条件为假，则else执行后面语句</div><div class="line">	语句3</div><div class="line">	语句4</div><div class="line">	。。。</div><div class="line">fi</div></pre></td></tr></table></figure></p>
<p><strong><strong>多分支的if语句</strong></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">if 判断条件1； then</div><div class="line">	statement1</div><div class="line">	。。。</div><div class="line">elif 判断条件2； then</div><div class="line">	statement2</div><div class="line">	。。。</div><div class="line">elif 判断条件3； then</div><div class="line">	statement3</div><div class="line">	。。。</div><div class="line">else</div><div class="line">	statement4</div><div class="line">	。。。</div><div class="line">fi</div></pre></td></tr></table></figure></p>
<h4 id="示例3："><a href="#示例3：" class="headerlink" title="示例3："></a>示例3：</h4><p>查看用户user17是否存在，存在在屏幕显示。否则创建并添加密码，并通知创建成功。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">NAME=user17</div><div class="line"></div><div class="line">if id $NAME &amp;&gt; /dev/null; then</div><div class="line">	echo &quot;$NAME exists&quot;</div><div class="line">else</div><div class="line">	useradd $NAME</div><div class="line">	echo $NAME | passwd --stdin $NAME &amp;&gt; /dev/null</div><div class="line">	echo  &quot;Add $NAME finished&quot; </div><div class="line">fi</div></pre></td></tr></table></figure></p>
<h4 id="示例4："><a href="#示例4：" class="headerlink" title="示例4："></a>示例4：</h4><p>1、如果用户UID为0，显示其为管理员<br>2、否则，显示其为普通用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">NAME=root</div><div class="line">#NAME=user1</div><div class="line">USERID=`id -u $NAME`</div><div class="line">#</div><div class="line">if [ $USERID -eq 0 ]; then</div><div class="line">	echo &quot;Admin&quot;</div><div class="line">else</div><div class="line">	echo &quot;Common user&quot;</div><div class="line">fi</div></pre></td></tr></table></figure></p>
<p><code>也可以</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">NAME=root</div><div class="line">#NAME=user1</div><div class="line">#</div><div class="line">if [ `id -u $NAME` -eq 0 ]; then</div><div class="line">	echo &quot;Admin&quot;</div><div class="line">else</div><div class="line">	echo &quot;Common user&quot;</div><div class="line">fi</div><div class="line"></div><div class="line">#`id -u $NAME`为执行结果</div><div class="line">#	例：id -u user1</div><div class="line">#		其执行结果为1001，所以用单引号引起</div><div class="line">#id $NAME为状态结果</div><div class="line">#	例：echo $?</div><div class="line">#		其状态结果为1或者0</div><div class="line">#所以本题中使用的是查看执行结果进行比较</div></pre></td></tr></table></figure>
<ul>
<li>在bash中，要引用一个命令是否能够执行成功，想要引用这个命令的状态结果一定不能加引号;</li>
<li>要么让其执行成功（状态结果），要么取其执行状态结果$?;</li>
</ul>
<h4 id="示例5："><a href="#示例5：" class="headerlink" title="示例5："></a>示例5：</h4><p>判断当前系统上是否有用户的默认shell为bash：<br>    如果有，就显示其中一个用户名；<br>    否则就显示没有此类用户；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">grep &quot;\&lt;bash$&quot; /etc/passwd &amp;&gt; /dev/null</div><div class="line">RETVAL=$?</div><div class="line"></div><div class="line">if [ $RETVAL -eq 0 ]; then</div><div class="line">	AUSER=`grep &quot;\&lt;bash$&quot; /etc/passwd | head -l | cut -d: -f1&apos;</div><div class="line">	echo &quot;$AUSER is one of such users.&quot;</div><div class="line">else</div><div class="line">	echo &quot;No such user&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<h4 id="示例6："><a href="#示例6：" class="headerlink" title="示例6："></a>示例6：</h4><p>给定一个文件，比如/etc/inittab，判断此文件中是否有空白行：<br>    如果有，则显示其空白行数；<br>    否则，显示没有空白行；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">FILE=/etc/inittab</div><div class="line">if [ ! -e $FILE ]; then</div><div class="line">	echo &quot;No $FILE&quot;</div><div class="line">	exit 1</div><div class="line">fi</div><div class="line"></div><div class="line">KH=`grep &apos;^$&apos; /etc/inittab | wc -l`</div><div class="line">if [ $KH -gt 0 ]; then</div><div class="line">	echo &quot;$KH&quot;</div><div class="line">else </div><div class="line">	echo &quot;没有空白行&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<h4 id="示例7："><a href="#示例7：" class="headerlink" title="示例7："></a>示例7：</h4><p>给定一个用户，判断其UID与GID是否一样<br>    如果相同，就显示此用户为”good guy”；<br>    否则，就显示此用户为”bad guy”；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">username=user1</div><div class="line">userID=`id -u $USERNAME`</div><div class="line">groupID=`id -g $USERNAME`</div><div class="line">if [ $userID -eq $groupID ]; then</div><div class="line">	echo &quot;good guy&quot;</div><div class="line">else</div><div class="line">	echo &quot;bad guy&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p><code>进一步要求</code><br>不使用id命令获取其id号；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">USERNAME=user1</div><div class="line">if ! grep &quot;^$USERNAME\&gt;&quot; /etc/passwd &amp;&gt; /dev/null; then</div><div class="line">	echo &quot;No such user：$USERNAME&quot;</div><div class="line">	exit 1</div><div class="line">fi</div><div class="line"></div><div class="line">userID=`grep &quot;^$USERNAME\&gt;&quot; /etc/passwd | cut -d: -f3`</div><div class="line">groupID=`grep &quot;^$USERNAME\&gt;&quot; /etc/passwd | cut -d: -f4`</div><div class="line">if [ $userID -eq $groupID ]; then</div><div class="line">	echo &quot;good guy&quot;</div><div class="line">else</div><div class="line">	echo &quot;bad guy&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p><strong><strong>shell中使用算数运算</strong></strong><br>    A=3<br>    B=6<br>    使用算数运算表达式进行计算</p>
<ul>
<li><p>let命令：<br>let C=$A+$B</p>
</li>
<li><p>$[算数运算表达式]<br>C=$[$A+$B]</p>
</li>
<li><p>$((算数运算表达式))<br>C=$(($A+$B))</p>
</li>
<li><p>expr 算术运算表达式，表达式中个操作数及运算符之间要有空格，而且要使用命令引用</p>
<ul>
<li>C=`expr $A + $B`</li>
</ul>
<p>圆整：丢弃小数点后面数字，取得整数<br>在此取得的时间戳都会进行圆整</p>
</li>
</ul>
<h4 id="示例8："><a href="#示例8：" class="headerlink" title="示例8："></a>示例8：</h4><p>给定一个用户，获取其密码警告期限，然后判断用户最近一次修改密码时间距其最长使用期限是否小于警告期限；<br>    提示：算出运算的方法$[$A-$B]:表示变量A的值减去变量B的值的结果；<br>    如果小于，则显示”warning”；<br>    否则，就显示”OK”；<br><code>帮助命令</code><br>    bc<br>    date +%s</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">TIMESTAMP=&apos;date +%s&apos;</div><div class="line">let THEDAYTIME=$TIMESTAMP/86400</div><div class="line">echo $THEDAYTIME	# 1970到现在天数	</div><div class="line"> </div><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">W=`grep &quot;student&quot; /etc/shadow | cut -d: -f6`</div><div class="line">S=`date +%s`</div><div class="line">T=`expr $S/86400`</div><div class="line">L=`grep &quot;^student&quot; /etc/shadow | cut -d: -f3`</div><div class="line">SY=$[$L-$[$T-$N]]</div><div class="line"></div><div class="line">if [ $SY -lt $W ]; then	</div><div class="line">	echo &apos;worning&apos;</div><div class="line">else</div><div class="line">	echo &apos;OK&apos;</div><div class="line">fi</div></pre></td></tr></table></figure>
<h4 id="示例9："><a href="#示例9：" class="headerlink" title="示例9："></a>示例9：</h4><p>判定命令历史中的历史命令的总条目是否大于1000；<br>    如果大于，则显示”some command will gone”；<br>    否则显示”OK”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#！/bin/bash</div><div class="line">#</div><div class="line">HISTORY=&apos;history | tail -l | cut -d&apos; &apos; -f2&apos;</div><div class="line"></div><div class="line">if [ $HISTORY -qt 1000 ]; then</div><div class="line">	echo &quot;some command will gone&quot;</div><div class="line">else</div><div class="line">	echo &quot;OK&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p><strong><strong>文件判断</strong></strong></p>
<h4 id="示例10："><a href="#示例10：" class="headerlink" title="示例10："></a>示例10：</h4><p>判断一个文件是否存在例/etc/inittab</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">FILE=/etc/inittab</div><div class="line"></div><div class="line">if [ -e $FILE ]; then</div><div class="line">	echo &quot;OK&quot;</div><div class="line">else</div><div class="line">	echo &quot;No such file&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<h4 id="示例11："><a href="#示例11：" class="headerlink" title="示例11："></a>示例11：</h4><p>给定一个文件；<br>如果是一个普通文件，就显示；<br>如果是一个目录，也显示；<br>否则，显示此为无法识别文件；<br>定义状态码222；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash </div><div class="line">#</div><div class="line">FIEL=/etc/inittab</div><div class="line"></div><div class="line">if [ ! -e $FILE ]; then</div><div class="line">	echo &quot;No such file&quot;</div><div class="line">	exit 222</div><div class="line">fi</div><div class="line"></div><div class="line">if [ -f $FILE ]; then</div><div class="line">	echo &quot;Common file&quot;</div><div class="line">elif [ -d $FIEL ]; then</div><div class="line">	echo &quot;Directory&quot;</div><div class="line">else</div><div class="line">	echo &quot;Unknown&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p><strong><strong>变量运用</strong></strong></p>
<h3 id="示例12："><a href="#示例12：" class="headerlink" title="示例12："></a>示例12：</h3><p>脚本名称为filetest<br>接受一个参数（文件路径）<br>判定：此参数如果是存在文件，显示“OK”；<br>否则显示“No such file”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">if [ $# -lt 1 ]; then</div><div class="line">	echo &quot;Usage : ./filetest.sh ARG1 [ARG2 ...]&quot;</div><div class="line">	exit 7</div><div class="line">fi</div><div class="line">  </div><div class="line">if [ -e $1 ]; then</div><div class="line">	echo &quot;OK&quot;</div><div class="line">else</div><div class="line">	echo &quot;No such file&quot;</div><div class="line">fi</div></pre></td></tr></table></figure>
<p>执行：<br>./filetest.sh /etc/inittab</p>
<p><strong><strong>shift轮换用法</strong></strong></p>
<h4 id="示例13："><a href="#示例13：" class="headerlink" title="示例13："></a>示例13：</h4><p>shift命令可以一次行轮换多条参数，默认为1<br>脚本名称为：shift<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">echo $1</div><div class="line">shift</div><div class="line">echo $1</div><div class="line">shift</div><div class="line">echo $1</div></pre></td></tr></table></figure></p>
<p>执行：<br>./shift.sh 1 2 3<br>显示：<br>    1<br>    2<br>    3</p>
<h4 id="示例14："><a href="#示例14：" class="headerlink" title="示例14："></a>示例14：</h4><p>多个轮换参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">echo $1</div><div class="line">shift 2</div><div class="line">echo $1</div><div class="line">shift 2</div><div class="line">echo $1</div></pre></td></tr></table></figure>
<p>执行：<br>./shift.sh 1 2 3 4 5<br>显示：<br>    1<br>    3<br>    5</p>
<h4 id="示例15："><a href="#示例15：" class="headerlink" title="示例15："></a>示例15：</h4><p>给脚本传递两个参数（整数）；<br>显示此两者之和，和乘积；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">if [ $# -lt 2 ]; then</div><div class="line">	echo &quot;Usage:calc.sh ARG1 ARG2&quot;</div><div class="line">	exit 3</div><div class="line">fi</div><div class="line"></div><div class="line">echo &quot;The sum is: $[$1+$2]&quot;</div><div class="line">echo &quot;The prod is：$[$1*$2]&quot;</div></pre></td></tr></table></figure>
<p><strong><strong>组合测试条件：</strong></strong></p>
<ul>
<li>-a：与关系</li>
<li>-o：或关系</li>
<li>!：非关系</li>
</ul>
<p><code>用户给的参数是否大于1并且小于3；</code><br>if [ $# -gt 1 -a $# -le 3 ]<br>if [ $# -gt 1 ] &amp;&amp; [ $# -le 3 ]</p>
<h4 id="示例16："><a href="#示例16：" class="headerlink" title="示例16："></a>示例16：</h4><p>用户输入：q、Q、quit、Quit；其结果为退出，输入其他为无法识别参数；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line">if [ $1 == &apos;q&apos; -o $1 == &apos;Q&apos; -o $1 == &apos;Quit&apos; -o $1 == &apos;quit&apos; ]; then</div><div class="line">  echo &quot;Quiting...&quot;</div><div class="line">  exit 0</div><div class="line">else</div><div class="line">  echo &quot;Unknown Argument.&quot;</div><div class="line">  exit 1</div><div class="line">fi</div></pre></td></tr></table></figure>
<p><strong><strong>附值表达式：</strong></strong><br><code>将一个变量的值经过运算还保存回这个变量的空间当中去</code></p>
<ul>
<li>-=：减等</li>
<li>+=：加等</li>
<li>*=：乘等</li>
<li>/=：除等</li>
<li>%=：取模等于（一个变量等于在他自身以后取模再放回这个变量，例：14对3取模值为2）</li>
</ul>
<h5 id="某个变量等于自身加某个其他变量可以使用-I"><a href="#某个变量等于自身加某个其他变量可以使用-I" class="headerlink" title="某个变量等于自身加某个其他变量可以使用+=$I"></a>某个变量等于自身加某个其他变量可以使用+=$I</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">let SUM+=$I</div><div class="line">let I=$[$I+1]</div><div class="line">SUM=$[$SUM+$I]</div><div class="line">	</div><div class="line">let I+=1 相当于 let I++</div><div class="line">let I-=1 相当于 let I--</div></pre></td></tr></table></figure>
<h4 id="示例17"><a href="#示例17" class="headerlink" title="示例17:"></a>示例17:</h4><p>计算100以内所有奇数之和以及所有偶数之和；分别显示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#</div><div class="line"></div><div class="line">declare -i EVENSUM=0</div><div class="line">declare -i ODDSUM=0</div><div class="line"></div><div class="line">for I in &#123;1..100&#125;;do</div><div class="line">	if [ $[$I%2] -eq 0 ];then</div><div class="line">		let EVENSUM+=$I</div><div class="line">	else</div><div class="line">		let ODDSUM+=$I</div><div class="line">	fi</div><div class="line">done</div><div class="line"></div><div class="line">echo &quot;Odd sum is:$ODDSUM&quot;</div><div class="line">echo &quot;Even sum is:$EVENSUM&quot;</div></pre></td></tr></table></figure></p>

            
        
        </div>
        
            
            
        
    </article>
    
        
    <nav class="article-page">
        
            <a href="/2017/05/04/正则表达式/" id="art-left" class="art-right">
                <span class="next-title">
                    正则表达式总结<i class="iconfont icon-right"></i> 
                </span>
            </a>
        
        
            <a href="/2017/05/02/bash_变量/" id="art-right" class="art-left">
                <span class="prev-title"> 
                    <i class="iconfont icon-left"></i>bash变量
                </span>
            </a>
        
    </nav>

        
    


        </main>
        <footer class="footer syuanpi fadeIn" id="footer">
    <hr>
    <div class="footer-wrapper">
        <div class="left">
            <div class="contact-icon">
    
    
    
    
    
    
    
    
</div>
        </div>
        <div class="right">
            <div class="copyright">
    <div class="info">
        <span>&copy;</span>
        <span>2016 ~ 2017</span>
        <span>❤</span>
        <span>nigaha</span>
    </div>
    <div class="theme">
        <span>
            动力来源于
            <a href="http://hexo.io/" target="_blank">Hexo </a>
        </span>
        <span>
            主题
            <a href="http://nigaha.com"> 眼一睁 </a>
        </span>
    </div>
    
</div>
        </div>
    </div>
</footer>
    </div>
    <script src="/script/nlvi.js"></script>
<script src="/script/search.js"></script>

    <script src="/lightbox/js/lightbox.min.js"></script>

<script>
$(document).ready(function(){
    document.body.addEventListener('touchstart', function () {});
    $('.progress').hide();
    $('.body').show();
    Nlvi.tagcloud();
    Nlvi.mobileHeader();
    Nlvi.back2top();
    Nlvi.smoothScroll();
    Nlvi.onView();
    Nlvi.showToc();
    Nlvi.showComments();
    Nlvi.showReward();

    !CONFIG.animate && Nlvi.offAnimate();
    CONFIG.lightbox && Nlvi.onPicBox();
})
</script>
    </div>
    
        
    
    <div class="backtop syuanpi dead toTop" id="backtop">
    <i class="iconfont icon-up"></i>
    <span style="text-align:center;font-family:Georgia;"><span style="font-family:Georgia;" id="scrollpercent">1</span>%</span>
</div>
    
    <div class="search" id="search">
        <div class="mask" id="mask"></div>
        <div class="search-wrapper syuanpi">
            <h1 id="search-header" class="syuanpi">搜索一下？</h1>
            <div class="input">
                <input type="text" id="local-search-input" results="0" name="">
            </div>
            <div id="local-search-result"></div>
        </div>
    </div>
    <script>
    var GREETING = {
        morning: "当我们探索时，就要发现到真理",
        noon: "人的天职在于勇于探索真理。",
        after: "一件事实是一条没有性别的真理",
        night: "真理有时可能变得黯淡，但它永远不会熄灭",
        midnight: "真理在人那里获得生命力，并且展现出来"
    }
    $(document).ready(function(){
        Nlvi.search();
    });
    </script>

</body>
</html>
